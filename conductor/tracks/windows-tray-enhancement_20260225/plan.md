# Implementation Plan: Windows Tray Icon Enhancement

**Track ID:** windows-tray-enhancement_20260225
**Spec:** [spec.md](./spec.md)
**Created:** 2026-02-25
**Status:** [x] Implemented

## Overview

Add dynamic tray icon switching for Windows, a daily progress bar component for the main view, and a pin-icon guide in settings.

## Phase 1: Dynamic Tray Icon

Swap tray icon between idle and active states based on timer.

### Tasks

- [x] Task 1.1: Create `tray-idle.png` and `tray-active.png` icon assets in `apps/tauri/src-tauri/icons/`
- [x] Task 1.2: Add `update_tray_icon_state(active: bool)` Rust command in `apps/tauri/src-tauri/src/lib.rs` — loads the appropriate icon file and calls `tray.set_icon()`
- [x] Task 1.3: Update `apps/tauri/src/hooks/useTrayTimer.ts` — on Windows path, invoke `update_tray_icon_state` based on whether `startedAt` is present

### Verification

- [ ] Tray icon shows idle icon when no timer running
- [ ] Tray icon switches to active icon when timer starts
- [ ] macOS bitmap rendering unaffected

## Phase 2: Daily Progress Bar

Add an in-app progress bar for Windows users since tray icon can't show progress.

### Tasks

- [x] Task 2.1: Create `apps/tauri/src/components/DailyProgressBar.tsx` — thin bar (4px) with grey track, blue fill, and `{logged}h / 8h` label
- [x] Task 2.2: Update `apps/tauri/src/views/MainView.tsx` — render DailyProgressBar at top, only on Windows; pass `dailyProgress` from App.tsx via props or context

### Verification

- [ ] Progress bar visible on Windows at top of MainView
- [ ] Progress bar not visible on macOS
- [ ] Progress updates as worklogs are added

## Phase 3: Pin Icon Guide

Show a dismissible tip in Settings for Windows users.

### Tasks

- [x] Task 3.1: Add `pinIconDismissed` field to `AppSettings` in `apps/tauri/src/lib/types.ts` and default in `apps/tauri/src/lib/settings.ts`
- [x] Task 3.2: Update `apps/tauri/src/views/SettingsView.tsx` — add dismissible info banner when Windows detected and `pinIconDismissed` is false; on dismiss, save setting

### Verification

- [ ] Banner shows on Windows in Settings when not dismissed
- [ ] Banner hidden after dismiss and doesn't reappear
- [ ] Banner not shown on macOS

## Final Verification

- [ ] All acceptance criteria met
- [ ] No regressions on macOS
- [ ] Ready for review

---

_Generated by Conductor. Tasks will be marked [~] in progress and [x] complete._
